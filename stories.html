<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Memoir App â€” My Stories</title>
<style>
:root{
  --bg:#f8f7f5; --card:#ffffff; --ink:#2f2a25; --muted:#6f6a65;
  --brand:#6b4c2f; --brand2:#7b5bff; --border:#e8e5e1; --radius:18px;
  --shadow:0 10px 30px rgba(0,0,0,.06);
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}

/* Header shared */
header{position:sticky;top:0;z-index:10;background:#fff;border-bottom:1px solid var(--border);box-shadow:0 2px 10px rgba(0,0,0,.02)}
.nav{max-width:1100px;margin:0 auto;padding:12px 16px;display:flex;align-items:center;justify-content:space-between;gap:10px}
.brandblock{display:flex;flex-direction:column}
.brand{font-weight:800;color:var(--ink)}
.sub{color:var(--muted);font-size:12px}
.menu{display:flex;gap:10px;align-items:center}
.pill{display:inline-flex;align-items:center;justify-content:center;background:#fff;border:1px solid var(--border);border-radius:999px;padding:10px 14px;min-width:110px;font-weight:600;color:var(--ink);text-decoration:none}
.pill:hover{border-color:#ddd}
select.pill{appearance:none;padding-right:28px;background:
  linear-gradient(45deg,transparent 50%,#999 50%) right 10px center/8px 8px no-repeat,
  linear-gradient(135deg,#999 50%,transparent 50%) right 4px center/8px 8px no-repeat, #fff}

.wrap{max-width:1100px;margin:20px auto;padding:0 16px}
.panel{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}

/* Summary */
.summary{display:grid;grid-template-columns:1fr;gap:12px;margin-bottom:14px}
@media(min-width:900px){.summary{grid-template-columns:2fr 1fr}}
.statrow{display:flex;gap:12px;flex-wrap:wrap}
.stat{flex:1;min-width:160px;background:#fff;border:1px solid var(--border);border-radius:12px;padding:14px;text-align:center}
.stat b{display:block;font-size:22px}
.invite{background:#fff;border:1px dashed var(--border);border-radius:12px;padding:14px;display:flex;gap:8px;align-items:center}
.invite input{flex:1;border:1px solid var(--border);border-radius:10px;padding:10px}
.btn{background:var(--brand);color:#fff;border:0;border-radius:10px;padding:10px 14px;font-weight:800;cursor:pointer}

/* List */
.list{display:grid;gap:10px}
.story{border:1px solid var(--border);border-radius:14px;background:#fff;padding:12px;display:flex;gap:10px;align-items:center}
.thumb{width:70px;height:70px;object-fit:cover;border-radius:10px;border:1px solid var(--border);background:#eee}
.meta{min-width:0}
.meta h4{margin:0}
.small{color:var(--muted);font-size:12px}
</style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="nav">
      <div class="brandblock">
        <div class="brand">MEMOIR APP â€” Preserve your memories forever</div>
        <div class="sub">Record â€¢ Transcribe â€¢ Share privately with family</div>
      </div>
      <nav class="menu">
        <a class="pill" href="landing.html">Home</a>
        <a class="pill" href="login.html">Login</a>
        <a class="pill" href="record.html">Record</a>
        <a class="pill" href="stories.html">My Stories</a>
        <select class="pill" id="lang">
          <option value="en">ðŸ‡ºðŸ‡¸ English</option>
          <option value="fr">ðŸ‡«ðŸ‡· FranÃ§ais</option>
          <option value="nl">ðŸ‡³ðŸ‡± Nederlands</option>
          <option value="es">ðŸ‡ªðŸ‡¸ EspaÃ±ol</option>
        </select>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <!-- Summary -->
    <section class="summary">
      <div class="panel">
        <div class="statrow">
          <div class="stat"><b id="storyCount">0</b><div class="small">Stories</div></div>
          <div class="stat"><b id="familyCount">0</b><div class="small">Family members</div></div>
        </div>
      </div>
      <div class="panel">
        <div class="invite">
          <input id="inviteEmail" type="email" placeholder="Invite family (read-only): name@example.com"/>
          <button class="btn" id="inviteBtn">Send Invite</button>
        </div>
        <div class="small" style="margin-top:6px;color:#6f6a65">Invited members can read and listen to your stories. (Admin can revoke at any time.)</div>
      </div>
    </section>

    <!-- Library list -->
    <section class="panel">
      <div class="list" id="list"></div>
    </section>
  </main>

<script>
  // language persistence
  const langSel=document.getElementById('lang');
  langSel.value = localStorage.getItem('memoir.lang') || 'en';
  langSel.addEventListener('change',()=>localStorage.setItem('memoir.lang', langSel.value));

  // Local storage stories fallback (if not using Supabase yet)
  const LSKEY='memoir.stories';
  const loadStories=()=>{ try{return JSON.parse(localStorage.getItem(LSKEY)||'[]')}catch{return[]} };
  const listEl=document.getElementById('list');

  function renderList(items){
    listEl.innerHTML='';
    if(!items.length){ const p=document.createElement('p'); p.className='small'; p.textContent='No stories yet.'; listEl.appendChild(p); return; }
    items.forEach(s=>{
      const row=document.createElement('div'); row.className='story';
      const img=document.createElement('img'); img.className='thumb'; img.alt=''; img.src=s.photo||''; if(!s.photo) img.style.display='none';
      const meta=document.createElement('div'); meta.className='meta';
      const h=document.createElement('h4'); h.textContent=s.title||'Story';
      const d=document.createElement('div'); d.className='small'; d.textContent=s.happened_label || (s.created?new Date(s.created).toLocaleString():'');
      meta.appendChild(h); meta.appendChild(d);
      row.appendChild(img); row.appendChild(meta);
      listEl.appendChild(row);
    });
  }

  // simple counts (replace with Supabase queries when ready)
  function getCounts(){
    const items = loadStories();
    const storyCount = items.length;
    // demo: store/read family members in localStorage for now
    const fam = JSON.parse(localStorage.getItem('memoir.family')||'[]');
    return { storyCount, familyCount: fam.length };
  }

  function refreshSummary(){
    const {storyCount, familyCount} = getCounts();
    document.getElementById('storyCount').textContent = storyCount;
    document.getElementById('familyCount').textContent = familyCount;
  }

  document.getElementById('inviteBtn').onclick = ()=>{
    const email = document.getElementById('inviteEmail').value.trim();
    if(!email){ alert('Please enter an email.'); return; }
    const fam = JSON.parse(localStorage.getItem('memoir.family')||'[]');
    if(!fam.includes(email)) fam.push(email);
    localStorage.setItem('memoir.family', JSON.stringify(fam));
    document.getElementById('inviteEmail').value='';
    refreshSummary();
    alert('Invite queued (demo). Wire this to Supabase to send a real email or generate a share code.');
  };

  // initial
  refreshSummary();
  renderList(loadStories());
</script>
</body>
</html>
