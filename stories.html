<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Memoir — My Stories</title>
  <link rel="stylesheet" href="/styles.css">
  <style>
    :root{
      --bg:#f6f1ea; --card:#fffaf5; --ink:#3b2f2a; --muted:#7b6a62;
      --accent:#8c5a3c; --accent2:#b17d55; --radius:18px;
      --shadow:0 18px 40px rgba(59,47,42,.10), 0 2px 8px rgba(59,47,42,.06);
    }
    body{background:var(--bg);color:var(--ink);margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .container{max-width:1100px;margin:0 auto;padding:20px 16px 28px}
    .title{font-size:clamp(26px,3vw,38px);margin:8px 0 10px}
    .muted{color:var(--muted)}
    .cards{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-top:14px}
    @media (max-width:980px){ .cards{grid-template-columns:1fr} }
    .card{background:var(--card);border:1px solid rgba(0,0,0,.08);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 16px;border-radius:999px;border:1px solid rgba(0,0,0,.12);background:#fff;color:var(--ink);text-decoration:none;font-weight:700}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;border:0}
    .list{display:grid;gap:10px;margin-top:8px}
    .story{padding:12px;border-radius:12px;border:1px solid rgba(0,0,0,.1);background:#fff}
    .small{font-size:12px;color:var(--muted)}
    input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(0,0,0,.15);background:#fff;color:inherit}
    .label{font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);margin:6px 0}
  </style>
</head>
<body>
  <div id="site-header"></div>

  <main class="container">
    <h1 class="title" id="storiesTitle">My Stories</h1>
    <p class="muted" id="storiesLead">Record once, keep for generations. Start a recording in one tap, add a title and “when it happened”, then share safely with your family.</p>

    <section class="cards">
      <!-- Stats + invite -->
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <div>
            <div class="label" id="storiesCountLabel">Stories</div>
            <div id="storiesCount" style="font-weight:800;font-size:28px">0</div>
          </div>
          <div>
            <div class="label" id="familyCountLabel">Family Members</div>
            <div id="familyCount" style="font-weight:800;font-size:28px">0</div>
          </div>
        </div>

        <div class="label" id="inviteLabel" style="margin-top:10px">Invite Family Member</div>
        <div class="row">
          <input id="inviteEmail" type="email" placeholder="email@example.com" aria-labelledby="inviteLabel">
          <button id="inviteBtn" class="btn">Invite</button>
        </div>
        <p class="small" id="inviteHint">They will receive a read-only link to view and listen.</p>
      </div>

      <!-- List -->
      <div class="card">
        <div class="row" style="justify-content:space-between;align-items:center">
          <div class="label" id="listLabel">My Stories</div>
          <a class="btn" href="/record.html" id="recordBtn">Record</a>
        </div>
        <div id="storiesList" class="list">
          <div class="story small" id="emptyState">No stories yet. Record your first one!</div>
        </div>
      </div>
    </section>
  </main>

  <div id="site-footer"></div>

  <!-- Scripts -->
  <script src="/js/lang.js" defer></script>
  <script src="/js/header-loader.js" defer></script>
  <script>
    // ---------- i18n ----------
    function localizeStories(lang){
      const t=(window.MEMOIR_I18N?.strings?.[lang]) || window.MEMOIR_I18N.strings.en;
      storiesTitle.textContent = t.nav_stories || 'My Stories';
      storiesLead.textContent  = t.storiesLead || storiesLead.textContent;
      storiesCountLabel.textContent = t.storiesCountLabel || 'Stories';
      familyCountLabel.textContent  = t.familyCountLabel || 'Family Members';
      inviteLabel.textContent = t.inviteLabel || 'Invite Family Member';
      inviteEmail.placeholder = t.invitePH || 'email@example.com';
      inviteBtn.textContent = t.inviteBtn || 'Invite';
      inviteHint.textContent = t.inviteHint || 'They will receive a read-only link to view and listen.';
      listLabel.textContent = t.listLabel || 'My Stories';
      recordBtn.textContent = t.nav_record || 'Record';
      if(document.getElementById('emptyState')) document.getElementById('emptyState').textContent = t.emptyState || 'No stories yet. Record your first one!';
    }
    window.addEventListener('memoir:lang', e=>localizeStories(e.detail.code));
    document.addEventListener('DOMContentLoaded', ()=>localizeStories(window.MEMOIR_I18N?.getLang?.() || 'en'));

    // ---------- (Optional) load stories from your API / Supabase ----------
    // You can replace this with a real fetch to your backend.
    async function loadStories(){
      try{
        const r = await fetch('/api/health'); // simple ping; replace with /api/list-stories
        // demo placeholder:
        const list = document.getElementById('storiesList');
        // If you render actual items, remove the empty state
        // list.innerHTML = '';
        // Example card:
        // const item = document.createElement('div');
        // item.className='story';
        // item.innerHTML = `<strong>Grandpa & the orchards</strong><div class="small">May 1946 • 2:34</div>`;
        // list.appendChild(item);
      }catch{}
    }
    loadStories();

    // Invite action placeholder
    document.getElementById('inviteBtn').onclick = ()=>{
      const email = document.getElementById('inviteEmail').value.trim();
      if(!email) return alert('Enter an email');
      alert('Invitation feature coming soon.');
    };
  </script>
</body>
</html>
